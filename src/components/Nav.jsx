import { useContext } from "react";
import { Link, useNavigate } from "react-router-dom";
import { AuthContext } from "../context/AuthContext";

import "../styles/navStyle.css";

function Nav({ onOpenModal }) {
  const { isAuthenticated, user, logout } = useContext(AuthContext);
  const navigate = useNavigate();

  const handleLogout = () => {
    logout();
    navigate("/");
  };

  return (
    <>
      <nav>
        <Link to="/">
          <div className="logo">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              viewBox="0 0 126 126"
              width="100%"
              height="100%"
              preserveAspectRatio="xMidYMid meet"
            >
              <path
                fill-rule="evenodd"
                d="M67.738,125.031 C72.049,119.248 74.237,104.790 75.358,91.166 C79.825,94.943 84.110,98.291 88.031,101.104 C97.617,107.956 102.867,109.974 105.967,109.974 C107.712,109.974 108.767,109.336 109.535,108.567 C111.685,106.418 112.779,102.029 102.085,87.050 C99.272,83.129 95.924,78.844 92.147,74.377 C105.771,73.256 120.229,71.068 126.012,66.757 L126.012,125.031 L67.738,125.031 ZM102.085,37.971 C112.779,22.992 111.685,18.603 109.549,16.467 C107.399,14.318 103.010,13.224 88.031,23.917 C84.110,26.731 79.825,30.078 75.358,33.855 C74.237,20.231 72.049,5.773 67.738,-0.010 L126.012,-0.010 L126.012,58.265 C120.229,53.953 105.771,51.765 92.147,50.645 C95.924,46.177 99.272,41.892 102.085,37.971 ZM70.890,44.666 C72.583,43.116 74.224,41.658 75.814,40.290 C92.095,26.158 102.710,20.257 105.693,20.257 L105.745,20.257 C105.797,23.201 99.910,33.829 85.713,50.189 C84.345,51.765 82.886,53.419 81.336,55.113 C83.642,55.217 85.856,55.360 87.966,55.503 C109.535,57.040 121.206,60.388 123.238,62.511 C121.206,64.634 109.535,67.981 87.966,69.518 C85.856,69.661 83.642,69.805 81.336,69.909 C82.886,71.602 84.345,73.256 85.713,74.832 C99.910,91.192 105.797,101.821 105.745,104.764 L105.693,104.764 C102.710,104.764 92.095,98.864 75.814,84.732 C74.224,83.364 72.583,81.905 70.890,80.355 C70.786,82.660 70.643,84.875 70.499,86.985 C68.962,108.555 65.615,120.225 63.492,122.257 C61.369,120.225 58.021,108.555 56.484,86.985 C56.341,84.875 56.198,82.660 56.093,80.355 C54.400,81.905 52.759,83.364 51.170,84.732 C34.889,98.864 24.273,104.764 21.290,104.764 L21.238,104.764 C21.186,101.821 27.073,91.192 41.271,74.832 C42.639,73.256 44.097,71.602 45.647,69.909 C43.342,69.805 41.128,69.661 39.018,69.518 C17.448,67.981 5.777,64.634 3.746,62.511 C5.777,60.388 17.448,57.040 39.018,55.503 C41.128,55.360 43.342,55.217 45.647,55.113 C44.097,53.419 42.639,51.765 41.271,50.189 C27.073,33.829 21.186,23.201 21.238,20.257 C24.221,20.192 34.836,26.079 51.170,40.277 C52.759,41.644 54.400,43.103 56.093,44.653 C56.198,42.348 56.341,40.147 56.484,38.036 C58.021,16.467 61.369,4.796 63.492,2.764 C65.615,4.796 68.962,16.467 70.499,38.036 C70.643,40.147 70.786,42.361 70.890,44.666 ZM38.952,23.917 C23.973,13.224 19.584,14.318 17.448,16.454 C15.299,18.603 14.205,22.992 24.898,37.971 C27.712,41.892 31.059,46.177 34.836,50.645 C21.212,51.765 6.754,53.953 0.971,58.265 L0.971,-0.010 L59.245,-0.010 C54.934,5.773 52.746,20.231 51.626,33.855 C47.158,30.078 42.873,26.731 38.952,23.917 ZM24.898,87.050 C14.205,102.029 15.299,106.418 17.435,108.555 C18.216,109.336 19.272,109.974 21.017,109.974 C24.117,109.974 29.366,107.956 38.952,101.104 C42.873,98.291 47.158,94.943 51.626,91.166 C52.746,104.790 54.934,119.248 59.245,125.031 L0.971,125.031 L0.971,66.757 C6.754,71.068 21.212,73.256 34.836,74.377 C31.059,78.844 27.712,83.129 24.898,87.050 Z"
              />
            </svg>
          </div>
        </Link>

        <ul>
          {isAuthenticated ? (
            <>
              <span className="welcome-message">
                {user?.username || "User"}
              </span>
              <button className="auth-btn logout" onClick={handleLogout}>
                Logout
              </button>
            </>
          ) : (
            <>
              <button
                className="auth-btn login"
                onClick={() => onOpenModal("login")}
              >
                Login
              </button>
              <button
                className="auth-btn register"
                onClick={() => onOpenModal("register")}
              >
                Register
              </button>
            </>
          )}
        </ul>
      </nav>
    </>
  );
}

export default Nav;
